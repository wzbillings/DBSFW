{
  "hash": "8df9d63c978e48f4a3648059441336c2",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Chapter 9: Bayesian Priors and Working with Probability Distributions\"\ndraft: false\n---\n\n::: {.cell}\n\n```{.r .cell-code}\noptions(\"scipen\" = 9999, \"digits\" = 4)\n```\n:::\n\n\n\n\n\nThis chapter introduces the concept of a prior probability distribution,\nrather than a single point prior (which is also, technically, a prior\ndistribution, but it is the degenerate distribution which is very boring).\n\n## Q1\n\n::: {.callout-note appearance=\"simple\"}\n\nA friend finds a coin on the ground, flips it, and gets six heads in a row and\nthen one tails. Give the beta distribution that describes this. Use integration\nto determine the probability that the true rate of flipping heads is between\n0.4 and 0.6, reflecting the belief that the coin is reasonably fair.\n\n:::\n\nThe beta distribution associated with the data we observed is\n$$\\text{Beta}(\\alpha = 6, \\beta = 1),$$\nsince flipping heads is the outcome of interest (the \"success\"). Integrating\nover the specified range, we get that\n$$P(0.4 \\leq p \\leq 0.6) = \\int_{0.4}^{0.6} \\text{Beta}(p \\mid 6, 1) \\ \\mathrm{d}p. $$\nApproximating the integral in R, we get the following result.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(q1res <- integrate(f = \\(x) dbeta(x, 6, 1), lower = 0.4, upper = 0.6))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n0.04256 with absolute error < 0.00000000000000047\n```\n\n\n:::\n:::\n\n\n\n\n\nOur prior probability that the true probability of flipping heads is between\n0.4 and 0.6 is approximately $4.26\\%$.\n\n## Q2\n\n::: {.callout-note appearance=\"simple\"}\n\nCome up with a prior probability that the coin *is* fair. Use a beta\ndistribution such that there is at least a 95\\% chance that the true rate of\nflipping heads is between 0.4 and 0.6.\n\n:::\n\nWe want to find a prior probability which guarantees\n$$0.95 \\leq \\int_{0.4}^{0.6} \\text{Beta}(p \\mid \\alpha, \\beta) \\ \\mathrm{d}p.$$\n\nWe know that $\\text{Beta}(1, 1)$ is uniform, so the probability will be too\nsmall in the interval we want. If we increase both numbers at the same time\nso that $\\alpha = \\beta$, we know that $p=0.5$ will be the most likely\nvalue, which is desirable for the prior we want to construct. So, if we\ninstead take $\\alpha = 6$ and $\\beta = 6$, we get the following result.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(q2res1 <- integrate(f = \\(x) dbeta(x, 6, 6), lower = 0.4, upper = 0.6))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n0.507 with absolute error < 0.0000000000000056\n```\n\n\n:::\n:::\n\n\n\n\n\nWe see that this prior still isn't strong enough to give us the coverage we\nwant in the given range. So let's try doubling both of the parameters.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(q2res2 <- integrate(f = \\(x) dbeta(x, 12, 12), lower = 0.4, upper = 0.6))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n0.6727 with absolute error < 0.0000000000000075\n```\n\n\n:::\n:::\n\n\n\n\n\nEven this still doesn't work -- we need an extremely strong beta prior to\nguarantee the probability we are interested in. So now I'll experiment with\nnumbers, testing a grid until we get what we want.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nparms <- 1:100\nq2res3 <- sapply(\n\tparms,\n\t\\(ab) integrate(f = \\(x) dbeta(x, ab, ab), lower = 0.4, upper = 0.6)$value\n)\n\n# Get the minimum number where the probability is above the target.\nprior_parm <- parms[[which(q2res3 >= 0.95)[[1]]]]\n```\n:::\n\n\n\n\n\nWe can obtain the correct probability bound by using a beta distribution where\nboth parameters are equal to $48$.\n\n## Q3\n\n::: {.callout-note appearance=\"simple\"}\n\nNow see how many more heads (with no more tails) it would take to convince you\nthat there is a reasonable chance that this coin is *not* fair. In this case,\nlet's say that this means that our belief in the rate of the coin being between\n0.4 and 0.6 drops below 0.5.\n\n:::\n\nWe know that the posterior distribution after we observe $k$ more heads is\nequal to\n$$\\text{Beta}(\\alpha = 48 + k, \\beta = 48),$$\nso now what we want to find is\n$$\n\\operatorname*{arg\\,min}_k \\int_{0.4}^{0.6} \\text{Beta}(p \\mid 48 \n+ k, 48) \\ \\mathrm{d}p.\n$$\nWe'll estimate $k$ using a grid search.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nk_vals <- 1L:100L\nintegral_values <- sapply(\n\tk_vals,\n\t\\(k) integrate(\n\t\tf = \\(x) dbeta(x, prior_parm + k, prior_parm),\n\t\tlower = 0.4,\n\t\tupper = 0.6\n\t)$value\n)\n(min_k <- k_vals[which(integral_values < 0.5)[[1]]])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 24\n```\n\n\n:::\n:::\n\n\n\n\n\nSo it would take 24 more heads in a row without any tail flips before\nour credibility that the coin is unfair is $50\\%$ or higher.\n\nWe can make a plot of the results as well to see this.\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(\n\tNULL, NULL,\n\txlim = c(0, 50), ylim = c(0, 1),\n\txlab = latex2exp::TeX(r'($k$)'),\n\tylab = latex2exp::TeX(r'($P(0.4 \\leq p \\leq 0.6)$)'),\n\taxes = FALSE\n)\naxis(1, at = c(seq(0, 50, 10), min_k))\naxis(2, at = c(seq(0, 1, 0.2), 0.5))\nabline(h = integral_values[min_k], lty = 2)\nabline(v = min_k, lty = 2)\nlines(1:50, integral_values[1:50], type = \"o\", lwd = 1.5)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\n<!--\n\n## Q4\n\n::: {.callout-note appearance=\"simple}\n\nWhat is the probability of either flipping two heads in two coin tosses or\nrolling three 6s in three six-sided dice rolls?\n\n:::\n\nI hate how vaguely worded this question is, so I'll list the assumptions that\nI think we are making.\n\nWe are doing one experiment that involves us flipping a coin twice (or flipping\ntwo coins) and also rolling a d6 three times (or rolling 3d6 one time). These\ntwo things are all mutually independent from each other, both coin flips are \nindependent, and all three die rolls are independent. The die rolls and coin\nflips do not affect each other. Once we have done all of these things during\nthe experiment, we want to know the probability that we flipped two heads OR\n(inclusive) we rolled three sixes.\n\nSo, we use inclusion-exclusion. We get that\n\n$$P(\\text{two heads}) = \\frac{1}{2}\\cdot \\frac{1}{2} = \\frac{1}{4},$$\n$$P(\\text{three sixes}) = \\left(\\frac{1}{6}\\right)^3 = \\frac{1}{216},$$\nand thus\n$$P(\\text{two heads} \\cup \\text{three sixes}) = \\frac{1}{4} + \\frac{1}{216} - \\frac{1}{4 \\cdot 216} = \\frac{219}{864} \\approx 25.35\\%.$$\n-->\n\n<!-- end of file -->\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}