{
  "hash": "3792fef0cc3a0ea6a37ac1cb692f5263",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Chapter 14: Parameter Estimation with Prior Probabilities\"\ndraft: false\n---\n\n::: {.cell}\n\n```{.r .cell-code}\noptions(\"scipen\" = 9999, \"digits\" = 4)\n```\n:::\n\n\n\n## Q1\n\n::: {.callout-note appearance=\"simple\"}\n\nSuppose you're playing air hockey with some friends and flip a coin to see who\nstarts with the puck. After playing 12 times, you realize that the friend who\nbrings the coin almost always seems to go first: 9 out of 12 times. Some of your\nother friends start to get suspicious. Define prior probability distributions\nfor the following beliefs:\n\n1. One person who weakly believes that the friend is cheating and the true\nrate of coming up heads is closer to 70 percent.\n1. One person who very strongly trusts that the coin is fair and provided a\n50 percent chance of coming up heads.\n1. One person who strongly believes the coin is biased to come up heads 70\npercent of the time.\n\n:::\n\nWe'll use a beta distribution for all three of the priors. For the first\nprior, we want a beta distribution with a mean that's close to 70 percent,\nbut we want the variance to be fairly high. The easiest way to do this, is\nto use $\\alpha = 7$ and $\\beta = 3$, which we know will have a mean of exactly\n$70\\%$ but will still be fairly spread out.\n\nFor the second prior, we'll use a beta distribution with equal parameters. Since\ntheir belief is fairly strong, we'll say $\\alpha = 10$, $\\beta = 10$. Finally,\nfor the third person, we'll use $\\alpha = 700$, $\\beta = 300$, which will have a\nmean of $70\\%$ but with little variation.\n\nLet's plot the three priors. The code for this plot is somewhat long, so it\nhas been hidden by default.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Setup\npal <- gray.colors(3, start = 0, end = 0.75)\nxs <- seq(1e-5, 1 - 1e-5, length.out = 1000)\nlayout(matrix(c(1, 2), nrow = 1))\n\n# PDF plot\np1 <- dbeta(xs, 7, 3)\np2 <- dbeta(xs, 10, 10)\np3 <- dbeta(xs, 700, 300)\nplot(\n\tNULL, NULL,\n\txlab = \"Probability of the coin being heads\",\n\tylab = \"Prior density (truncated at 4)\",\n\txlim = c(0, 1), ylim = c(0, 4),\n\taxes = FALSE,\n\tmain = \"Friends' prior PDFs\"\n)\nlines(xs, p1, lwd = 3, col = pal[[1]], lty = 1)\nlines(xs, p2, lwd = 3, col = pal[[2]], lty = 2)\nlines(xs, p3, lwd = 3, col = pal[[3]], lty = 3)\naxis(1, seq(0, 1, 0.25))\naxis(2, seq(0, 4, 1))\nlegend(\n\tx = 0, y = 3.9,\n\tlegend = c(\"Friend 1\", \"Friend 2\", \"Friend 3\"),\n\tcol = pal,\n\tlty = 1:3,\n\tlwd = 3\n)\n\n# CDF plot\nc1 <- pbeta(xs, 7, 3)\nc2 <- pbeta(xs, 10, 10)\nc3 <- pbeta(xs, 700, 300)\nplot(\n\tNULL, NULL,\n\txlab = \"Probability of the coin being heads\",\n\tylab = \"Cumulative prior probability\",\n\txlim = c(0, 1), ylim = c(0, 1),\n\taxes = FALSE,\n\tmain = \"Friends' prior CDFs\"\n)\nlines(xs, c1, lwd = 3, col = pal[[1]], lty = 1)\nlines(xs, c2, lwd = 3, col = pal[[2]], lty = 2)\nlines(xs, c3, lwd = 3, col = pal[[3]], lty = 3)\naxis(1, seq(0, 1, 0.25))\naxis(2, seq(0, 1, 0.25))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/q1 prior plot-1.png){width=672}\n:::\n:::\n\n\n\nWe can see that friend 3 is so certain, the PDF plot had to be truncated in\norder to see the other two curves.\n\n::: {.callout-note appearance=\"simple\"}\n\nTo test the coin, you flip it 20 more times and get 9 heads and 11 tails. Using\nthe priors you calculated in the previous question, what are the updated\nposterior beliefs in the true rate of flipping a heads in terms of the 95\npercent confidence interval?\n\n:::\n\nOK. now we need to compute the posteriors for each of the three friends.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npost1 <- dbeta(xs,  7 + 9,  3 + 11)\npost2 <- dbeta(xs, 10 + 9, 10 + 11)\npost3 <- dbeta(xs, 70 + 9, 30 + 11) \n```\n:::\n\n\n\nNext we need to calculate the posterior credible intervals.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nci_levels <- c(0.025, 0.975)\npost_cis <-\n\trbind(\n\t\tqbeta(ci_levels, 07 + 9, 03 + 11),\n\t\tqbeta(ci_levels, 10 + 9, 10 + 11),\n\t\tqbeta(ci_levels, 70 + 9, 30 + 11)\n\t) |>\n\t`colnames<-`(c(\"lower\", \"upper\")) |>\n\ttibble::as_tibble() |>\n\ttibble::add_column(friend = paste(1:3))\nprint(post_cis)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 Ã— 3\n  lower upper friend\n  <dbl> <dbl> <chr> \n1 0.357 0.706 1     \n2 0.324 0.628 2     \n3 0.572 0.740 3     \n```\n\n\n:::\n:::\n\n\n\nFinally, we can visualize the prior and posterior density with the CrI for\neach of our friends.\n\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# Setup\npal2 <- gray.colors(2, start = 0, end = 0.5)\nxs <- seq(1e-5, 1 - 1e-5, length.out = 1000)\nlayout(matrix(c(1, 2, 3), nrow = 1))\n\n# posterior/prior plots\n# Friend 1\nplot(\n\tNULL, NULL,\n\tmain = \"Friend 1\",\n\txlim = c(0, 1), ylim = c(0, 10),\n\txlab = \"Probability of the coin being heads\",\n\tylab = \"Density\",\n)\nlines(xs, p1,    lwd = 3, col = pal2[[2]], lty = 3)\nlines(xs, post1, lwd = 3, col = pal2[[1]], lty = 1)\nabline(v = post_cis[[1, 1]], lty = 2, lwd = 1, col = \"firebrick2\")\nabline(v = post_cis[[1, 2]], lty = 2, lwd = 1, col = \"firebrick2\")\n\nlegend(\n\tx = 0.02, y = 9.75,\n\tlegend = c(\"Prior\", \"Posterior\", \"95% CrI\"),\n\tcol = c(rev(pal2), \"firebrick2\"),\n\tlty = c(3, 1, 2),\n\tlwd = c(3, 3, 1)\n)\n\n# Friend 2\nplot(\n\tNULL, NULL,\n\tmain = \"Friend 2\",\n\txlim = c(0, 1), ylim = c(0, 10),\n\txlab = \"Probability of the coin being heads\",\n\tylab = \"Density\",\n)\nlines(xs, p2,    lwd = 3, col = pal2[[2]], lty = 3)\nlines(xs, post2, lwd = 3, col = pal2[[1]], lty = 1)\nabline(v = post_cis[[2, 1]], lty = 2, lwd = 1, col = \"firebrick2\")\nabline(v = post_cis[[2, 2]], lty = 2, lwd = 1, col = \"firebrick2\")\n\n# Friend 3\nplot(\n\tNULL, NULL,\n\tmain = \"Friend 3\",\n\txlim = c(0, 1), ylim = c(0, 10),\n\txlab = \"Probability of the coin being heads\",\n\tylab = \"Density\",\n)\nlines(xs, p3,    lwd = 3, col = pal2[[2]], lty = 3)\nlines(xs, post3, lwd = 3, col = pal2[[1]], lty = 1)\nabline(v = post_cis[[3, 1]], lty = 2, lwd = 1, col = \"firebrick2\")\nabline(v = post_cis[[3, 2]], lty = 2, lwd = 1, col = \"firebrick2\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/q2 posterior plot-1.png){width=672}\n:::\n:::\n\n\n\nOverall, we can see the following conclusions for each friend:\n\n1. Friend 1 did think the coin was unfair before, but is now much more willing\nto believe the coin is fair given the observed data;\n1. Friend 2 thought the coin was fair before and is now more confident that\nthe coin is fair given the observed data; and\n1. Friend 3 still strongly believes the coin is unfair, but the observed data\nis beginning to change their mind -- they are at least now willing to entertain\nthe possibility that the coin is fair.\n\n<!-- END OF FILE -->\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}